# Active Context

- Current focus: Finalize requirements and plan for the GitHub-like habit tracker.
- Latest inputs: personal-use, English-only; responsive web/mobile; frontend TypeScript + React Native + Tamagui with modern serif styling; backend Node.js + Fastify + Prisma on SQLite; frequencies daily/weekly/monthly/yearly/custom; optional start/end dates; no backdating; per-habit heatmaps with hover counts and click-to-view tasks; streak resets after 3 consecutive missed days (Istanbul timezone, TR format); site-internal push notifications; offline allowed after initial online load with cache-first assets, stale-while-revalidate API reads, and background sync for writes; no social/gamification; auth via username/password (min 8) + Google; password change from profile; export/import in JSON; daily automated backups; E2E encryption expected.
- Phase 1 (decisions) completed: Prisma, JSON export/import, offline/PWA approach, encryption stance, daily backups locked.
- Phase 2: Architecture draft added (`memory-bank/architecture.md`) with auth/session (httpOnly secure cookie + CSRF), data model, API contracts, offline sync, E2E notes. Decisions taken: soft delete via deletedAt, E2E recovery via user-held recovery key + re-encrypt on rotation, error envelope defined.
- Implementation started: backend scaffolded (`backend/`) with Fastify server, TypeScript config, core plugins (helmet, cors, cookie, formbody), npm scripts; Prisma initialized with SQLite (Prisma pinned to 5.19.1 for stability); schema defined with string-based frequency/job types and stringified customRule; `prisma db push` applied to local `prisma/dev.db` (migrate dev blocked in non-interactive env).
- New code: env config, Prisma plugin, crypto helpers, error envelope helper; session service with hashed tokens + CSRF cookie; auth routes for register/login/logout/me/password using zod + argon2; build passes (`npm run build`).
- Next: add auth/session middleware for reuse across routes, implement habits/logs/streak endpoints, and refine E2E key handling; revisit migrations when interactive shell available or continue db push for dev.
